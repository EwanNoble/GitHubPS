pool:
  vmImage: vs2017-win2016

name: $(GitVersion.FullSemVer)

trigger:
- master

pr:
- master

steps:
  - task: GitVersion@4
    displayName: "Run GitVersion"

  - task: PowerShell@1
    displayName: 'Execute Build'
    inputs:
      scriptName: tools/build.ps1

  - task: PublishBuildArtifacts@1
    displayName: 'Publish Artifact: Release'
    inputs:
      PathtoPublish: Release
      ArtifactName: Release

  - task: PublishTestResults@2
    displayName: "Publish Pester test results"
    inputs:
      testRunner: "NUnit"
      testResultsFiles: '$(System.DefaultWorkingDirectory)\Test-Pester.XML'
    condition: succeededOrFailed()
